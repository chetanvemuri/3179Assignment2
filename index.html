<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Tertiary Education & GDP per Capita — FIT3179 Assignment 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Vega Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    :root{
      --card-max: 860px;   /* max width for cards */
      --chart-max: 720px;  /* max width for charts inside cards */
    }
    html, body {
      margin: 0; padding: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #f7f9fc; color: #111; text-align: center;
    }
    header {
      background: #fff; border-bottom: 1px solid #ddd;
      padding: 30px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    h1 { font-size: 2rem; margin: 0; }
    p.sub { color: #666; margin: 5px 0 0; }

    main { max-width: var(--card-max); margin: 40px auto; padding: 0 16px; }
    section { margin: 40px 0; }
    h2 { font-size: 1.5rem; margin-bottom: 20px; }

    .card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      padding: 24px;
      margin: 0 auto;
      max-width: var(--card-max);
      overflow: hidden; /* ensure no overflow from charts */
    }

    /* Chart containers: centered and width-capped */
    #vis, #gdpVis {
      width: 100%;
      max-width: var(--chart-max);
      margin: 0 auto;
      min-height: 360px;
    }

    /* Make embedded SVG/canvas respect the cap */
    .vega-embed, .vega-embed > div, .vega-embed svg, .vega-embed canvas {
      max-width: var(--chart-max) !important;
      width: 100% !important;
      height: auto;
      margin: 0 auto !important;
      display: block;
    }
  </style>
</head>

<body>
  <header>
    <h1>Tertiary Education & GDP per Capita Around the World</h1>
    <p class="sub">FIT3179 Assignment 2 — Vega-Lite Visualisations</p>
  </header>

  <main>
    <!-- SECTION 1: Tertiary Education -->
    <section>
      <p style="margin-top:15px;color:#666;text-align: justify;">
        Living in Australia, it is easy to ignore the immense opportunities citizens are given to educate themselves and pursue a 
        pathway unique to each individual. Having been born into such a system, these luxuries are often taken for granted under the 
        assumption that this is just how the world operates. However, this couldn’t be further from the truth. Billions of people 
        live in a world where their pathways and options are restricted as they do not have the resources to pursue such dreams. 
        This can be explored through tertiary education completion rates across countries.
      </p>
      <div class="card">
        <div id="vis" aria-label="Completed tertiary education visualisation"></div>
      </div>
      <p style="margin-top:7px;color:#666;">
        Figure 1. Percentage of people with tertiary education in different countries.
      </p>
    </section>

    <!-- SECTION 2: GDP per Capita -->
    <section>
      <h2>Top 20 Countries by GDP per Capita (1960–2024)</h2>
      <p style="color:#666;text-align: justify;">
        Economic prosperity often goes hand-in-hand with access to quality education. 
        The following visualisation shows how the top 20 countries by GDP per capita have changed over time. 
        Use the slider to explore different years.
      </p>
      <div class="card">
        <div id="gdpVis" aria-label="Top 20 GDP per capita visualisation"></div>
      </div>
      <p style="margin-top:7px;color:#666;">
        Figure 2. Top 20 GDP per capita by year (World Bank data).
      </p>
    </section>
  </main>

  <script>
    /**
     * Load a Vega/Vega-Lite spec from URL, make it responsive,
     * then embed into a target container.
     */
    async function loadResponsiveSpec(targetSelector, specUrl) {
      try {
        const res = await fetch(specUrl, { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status} fetching ${specUrl}`);
        const spec = await res.json();

        // Force responsive sizing regardless of what's in the JSON
        spec.autosize = { type: "fit", contains: "padding" };
        spec.width = "container";
        // If the spec hard-codes a huge height, you can cap it here:
        // if (typeof spec.height === "number" && spec.height > 700) spec.height = 520;

        await vegaEmbed(targetSelector, spec, { actions: false, renderer: "canvas" });
      } catch (err) {
        console.error(err);
        const el = document.querySelector(targetSelector);
        el.innerHTML =
          "<pre style='color:#b00020;white-space:pre-wrap;'>Error loading visualisation:\n" + err + "</pre>";
      }
    }

    // Bump querystring if needed to bust cache after changes (v=…)
    loadResponsiveSpec("#vis", "completed_tertiary_education.vg.json?v=18");
    loadResponsiveSpec("#gdpVis", "gdp_per_capita.json?v=5");
  </script>
</body>
</html>
